(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{143:function(e,t,n){"use strict";n.r(t);var r,a,c,s,i,o,u,l,j=n(0),d=n(91),b=n(142),h=n(26),O=n(39),p=n.n(O),f=n(144),x=n(68),v=n(32),m=n(96),g=n(97),k=n(153),w=n.n(k),C=function(){return new h.ApolloLink((function(e,t){return new p.a((function(n){var r;return Promise.resolve(e).then((function(e){return function(e,t){var n=localStorage.getItem("token");e.setContext({headers:{authorization:n}})}(e)})).then((function(){r=t(e).subscribe({next:n.next.bind(n),error:n.error.bind(n),complete:n.complete.bind(n)})})).catch(n.error.bind(n)),function(){r&&r.unsubscribe()}}))}))},I=n(27),y="SET_AUTH_USER",S="CLEAR_AUTH_USER",U={user:null},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(I.a)(Object(I.a)({},e),{},{user:t.payload});case S:return Object(I.a)(Object(I.a)({},e),U);default:return e}},L=n(2),A=Object(j.createContext)(),N={auth:U},$=function(e,t){return{auth:E(e.auth,t)}},B=function(e){var t=e.children;return Object(L.jsx)(A.Provider,{value:Object(j.useReducer)($,N),children:t})},D=document.location.href.startsWith("http://localhost")?"http://localhost:4000/graphql":"",G=(n(135),n(159)),P=n(42),_=n(15),R=n(30),T=n(36),q=Object(T.a)(r||(r=Object(R.a)(["\nquery { \n  allUsers {\n    id\n    name\n    email\n    password\n    isOnline\n    lastLoginAt\n    createdAt\n    active\n  }\n}\n"]))),Q=Object(T.a)(a||(a=Object(R.a)(["\n  query {\n    getAuthUser {\n      id\n      name\n      email\n      createdAt\n      lastLoginAt\n      isOnline\n      }\n    }\n"]))),z=Object(T.a)(c||(c=Object(R.a)(["\n    mutation SIGNIN($email: String!,$password: String! ){\n      signin(email:$email, password: $password){\n        token\n      }\n    }\n"]))),M=Object(T.a)(s||(s=Object(R.a)(["\n    mutation SIGNUP($userInput: UserInputData ){\n      signup(userInput: $userInput){\n        token\n      }\n    }\n"]))),F=Object(T.a)(i||(i=Object(R.a)(["\n  mutation LOG_OUT($userId: String!){\n    logout(userId: $userId){\n      boolean\n    }\n  }\n"]))),H=Object(T.a)(o||(o=Object(R.a)(["\n  mutation DELETE_USERS($usersIds: [ID!]!){\n    deleteUsers(usersIds: $usersIds){\n      count\n    }\n  }\n"]))),J=Object(T.a)(u||(u=Object(R.a)(["\n  mutation BLOCK_USERS($usersIds: [ID!]!){\n    blockUsers(usersIds: $usersIds){\n      count\n    }\n  }\n"]))),K=Object(T.a)(l||(l=Object(R.a)(["\n  mutation UNBLOCK_USERS($usersIds: [ID!]!) {\n    unBlockUsers(usersIds: $usersIds){\n      count\n    }\n  }\n  "]))),W=n(17),V=n.n(W),X=n(24),Y=n(16),Z=n(162),ee=n(158),te=n(160),ne=n(35);function re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(j.useState)(e),n=Object(Y.a)(t,2),r=n[0],a=n[1],c=Object.values(e).join("");function s(e){var t=e.target,n=t.value,c=t.name,s=t.type;("number"===s&&(n=parseInt(n)),"file"===s)&&(n=Object(Y.a)(e.target.files,1)[0]);a(Object(I.a)(Object(I.a)({},r),{},Object(ne.a)({},c,n)))}return Object(j.useEffect)((function(){a(e)}),[c]),{inputs:r,handleChange:s}}var ae=Object(_.f)((function(e){var t=e.history,n=e.refetch,r=Object(j.useState)(""),a=Object(Y.a)(r,2),c=(a[0],a[1]),s=re({email:"",name:"",password:""}),i=s.inputs,o=s.handleChange,u=Object(Z.a)(M),l=Object(Y.a)(u,2),d=l[0],b=(l[1].loading,function(){var e=Object(X.a)(V.a.mark((function e(r){var a;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,d({variables:{userInput:i},refetchQueries:[{query:q}]});case 4:return a=e.sent,localStorage.setItem("token",a.data.signup.token),e.next=8,n();case 8:t.push("/"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),c(e.t0.graphQLErrors[0].message);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}());return Object(L.jsx)(L.Fragment,{children:Object(L.jsxs)(ee.a,{onSubmit:b,children:[Object(L.jsxs)(ee.a.Group,{children:[Object(L.jsx)(ee.a.Label,{children:"E-Mail"}),Object(L.jsx)(ee.a.Control,{name:"email",type:"text",value:i.email,placeholder:"email",onChange:o})]}),Object(L.jsxs)(ee.a.Group,{children:[Object(L.jsx)(ee.a.Label,{children:"Name"}),Object(L.jsx)(ee.a.Control,{name:"name",type:"text",value:i.name,placeholder:"name",onChange:o})]}),Object(L.jsxs)(ee.a.Group,{controlId:"formBasicPassword",children:[Object(L.jsx)(ee.a.Label,{children:"Password"}),Object(L.jsx)(ee.a.Control,{type:"password",name:"password",value:i.password,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",onChange:o})]}),Object(L.jsx)(te.a,{variant:"primary",type:"submit",children:"Sign Up"})]})})})),ce=Object(_.f)((function(e){var t=e.history,n=e.location,r=e.refetch,a=re({email:"",password:""}),c=a.inputs,s=a.handleChange,i=Object(j.useState)(""),o=Object(Y.a)(i,2),u=(o[0],o[1]),l=Object(Z.a)(z),d=Object(Y.a)(l,2),b=d[0];d[1].loading;Object(j.useEffect)((function(){u("")}),[n.pathname]);var h=function(){var e=Object(X.a)(V.a.mark((function e(n){var a;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,b({variables:{email:O,password:p},refetchQueries:[{query:q}]});case 4:return a=e.sent,localStorage.setItem("token",a.data.signin.token),e.next=8,r();case 8:t.push("/"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),u(e.t0.graphQLErrors[0].message);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),O=c.email,p=c.password;return Object(L.jsxs)(ee.a,{onSubmit:h,children:[Object(L.jsxs)(ee.a.Group,{children:[Object(L.jsx)(ee.a.Label,{children:"E-Mail"}),Object(L.jsx)(ee.a.Control,{name:"email",type:"text",value:O,placeholder:"email",onChange:s})]}),Object(L.jsxs)(ee.a.Group,{controlId:"formBasicPassword",children:[Object(L.jsx)(ee.a.Label,{children:"Password"}),Object(L.jsx)(ee.a.Control,{type:"password",name:"password",value:p,placeholder:"password",onChange:s})]}),Object(L.jsx)(te.a,{variant:"primary",type:"submit",children:"Sign In"})]})})),se=n(154),ie=n(155),oe=function(e){var t=e.refetch;return Object(L.jsx)(L.Fragment,{children:Object(L.jsx)(se.a,{children:Object(L.jsxs)(ie.a,{className:"justify-content-between gap-10 align-items-center vh-100",children:[Object(L.jsx)(ce,{refetch:t}),Object(L.jsx)(ae,{refetch:t})]})})})},ue=n(156),le=n(157),je=n(100);var de=function(e){var t=e.type,n=void 0===t?"checkbox":t,r=e.name,a=e.checked,c=void 0!==a&&a,s=e.onChange;return Object(L.jsx)("input",{type:n,name:r,checked:c,onChange:s})};function be(e){var t=new Date(+e);return t=t.toString().split(" "),"".concat(t[2]," ").concat(t[1]," ").concat(t[3]," ").concat(t[4])}function he(e){return Object.keys(Object.fromEntries(Object.entries(e).filter((function(e){var t=Object(Y.a)(e,2);t[0];return!1!==t[1]}))))}var Oe=function(e){var t=e.data,n=e.refetchUser,r=e.refetchAllUsers,a=Object(j.useState)([]),c=Object(Y.a)(a,2),s=c[0],i=c[1],o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object(j.useState)({}),n=Object(Y.a)(t,2),r=n[0],a=n[1];function c(e){var t=e.target,n=t.name,c=t.checked;a(Object(I.a)(Object(I.a)({},r),{},Object(ne.a)({},n,c)))}function s(e){var t=Object.fromEntries(Object.entries(r).map((function(t){var n=Object(Y.a)(t,2),r=n[0];return n[1],[r,e]})));a(t)}function i(){s(!0)}function o(){s(!1)}return Object(j.useEffect)((function(){a((function(){return Object.assign.apply(Object,[{}].concat(Object(je.a)(e.map((function(e,t){return Object(ne.a)({},e.id,!1)})))))}))}),[e]),{checkeds:r,handleChange:c,handleChangeAll:i,handleChangeNo:o}}(s),u=o.checkeds,l=o.handleChange,d=o.handleChangeAll,b=o.handleChangeNo,h=Object(Z.a)(H),O=Object(Y.a)(h,2),p=O[0],f=O[1],x=(f.loading,f.error,Object(Z.a)(J)),v=Object(Y.a)(x,2),m=v[0],g=v[1],k=(g.loading,g.error,Object(Z.a)(K)),w=Object(Y.a)(k,2),C=w[0],y=w[1],S=(y.loading,y.error,function(){var e=Object(X.a)(V.a.mark((function e(){var t;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=he(u),e.next=4,m({variables:{usersIds:t}});case 4:return e.next=6,n();case 6:return e.next=8,r();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}()),U=function(){var e=Object(X.a)(V.a.mark((function e(){var t;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=he(u),e.next=4,C({variables:{usersIds:t}});case 4:return e.next=6,n();case 6:return e.next=8,r();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(X.a)(V.a.mark((function e(){var t;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=he(u),e.next=4,p({variables:{usersIds:t}});case 4:return e.next=6,n();case 6:return e.next=8,r();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(X.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r();case 3:return e.next=5,n();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(j.useEffect)(Object(X.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(t),e.next=3,r();case 3:case"end":return e.stop()}}),e)}))),[t]),Object(L.jsxs)(se.a,{children:[Object(L.jsx)(ie.a,{className:"justify-content-center",children:Object(L.jsxs)(ue.a,{children:[Object(L.jsx)(te.a,{onClick:S,children:"Block"}),Object(L.jsx)(te.a,{onClick:U,children:"UnBlock"}),Object(L.jsx)(te.a,{variant:"danger",onClick:E,children:"Delete"}),Object(L.jsx)(te.a,{variant:"success",onClick:A,children:"UpdateUsers"})]})}),Object(L.jsxs)(le.a,{striped:!0,bordered:!0,hover:!0,children:[Object(L.jsx)("thead",{children:Object(L.jsxs)("tr",{children:[Object(L.jsx)("th",{children:Object(L.jsxs)(ue.a,{size:"sm",children:[Object(L.jsx)(te.a,{onClick:d,children:"All"}),Object(L.jsx)(te.a,{onClick:b,children:"No"})]})}),Object(L.jsx)("th",{children:"Id"}),Object(L.jsx)("th",{children:"Name"}),Object(L.jsx)("th",{children:"Email"}),Object(L.jsx)("th",{children:"Date"}),Object(L.jsx)("th",{children:"Last Login"}),Object(L.jsx)("th",{children:"Online Offline"}),Object(L.jsx)("th",{children:"Status Block"})]})}),Object(L.jsx)("tbody",{children:s.map((function(e,t){return Object(L.jsxs)("tr",{children:[Object(L.jsx)("td",{children:Object(L.jsx)(de,{name:e.id,checked:u[e.id],onChange:l})}),Object(L.jsx)("td",{children:e.id}),Object(L.jsx)("td",{children:e.name}),Object(L.jsx)("td",{children:e.email}),Object(L.jsx)("td",{children:be(e.createdAt)}),Object(L.jsx)("td",{children:be(e.lastLoginAt)}),Object(L.jsx)("td",{children:!0===e.isOnline?"Online":"Offline"}),Object(L.jsx)("td",{children:!0===e.active?"Not Blocked":"Blocked"})]},e.id)}))})]})]})},pe=Object(_.f)((function(e){e.location;var t,n=e.authUser,r=e.refetch,a=Object(j.useContext)(A),c=Object(Y.a)(a,2),s=c[0].auth,i=c[1];Object(j.useEffect)((function(){i({type:y,payload:n})}),[i,n]);var o=Object(G.a)(q),u=o.data,l=o.loading,d=(o.error,o.refetch),b=u?null===u||void 0===u?void 0:u.allUsers:[],h=null===s||void 0===s||null===(t=s.user)||void 0===t?void 0:t.id,O=Object(Z.a)(F),p=Object(Y.a)(O,2),f=p[0],x=(p[1].loading,function(){var e=Object(X.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.localStorage.removeItem("token"),e.next=3,f({variables:{userId:h}});case 3:return e.next=5,r();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());return s.user?l?Object(L.jsx)("div",{children:"Loading..."}):Object(L.jsxs)(se.a,{className:"vh-100",children:[Object(L.jsx)(te.a,{variant:"danger",onClick:x,children:"Log Out"}),u&&Object(L.jsx)(Oe,{data:b,refetchUser:r,loadingAllUsers:l,refetchAllUsers:d})]}):null})),fe=function(){var e=Object(G.a)(Q),t=e.loading,n=e.data,r=e.error,a=e.refetch;return t?Object(L.jsx)("div",{children:"Loading..."}):r?Object(L.jsx)("div",{children:r}):Object(L.jsx)(P.a,{children:Object(L.jsx)(_.c,{children:n.getAuthUser?Object(L.jsx)(_.a,{exact:!0,render:function(){return Object(L.jsx)(pe,{authUser:n.getAuthUser,refetch:a})}}):Object(L.jsx)(_.a,{exact:!0,render:function(){return Object(L.jsx)(oe,{refetch:a})}})})})},xe=function(e,t){var n=new f.a,r=Object(m.a)((function(e){var t=e.graphQLErrors,n=e.networkError;t&&t.map((function(e){var t=e.message,n=e.locations,r=e.path;return console.log("[GraphQL error]: Message: ".concat(t,", Location: ").concat(n,", Path: ").concat(r))})),n&&console.log("[Network error]: ".concat(n))})),a=C(),c=w()({uri:e}),s=localStorage.getItem("token"),i=new g.a({uri:t,options:{timeout:6e4,reconnect:!0,connectionParams:{authorization:s}}});i.subscriptionClient.maxConnectTimeGenerator.duration=function(){return i.subscriptionClient.maxConnectTimeGenerator.max};var o=Object(h.split)((function(e){var t=e.query,n=Object(v.e)(t),r=n.kind,a=n.operation;return"OperationDefinition"===r&&"subscription"===a}),i,c);return new x.a({link:h.ApolloLink.from([r,a,o]),cache:n})}(D,D.replace("http://","ws://"));Object(d.render)(Object(L.jsx)(b.a,{client:xe,children:Object(L.jsx)(B,{children:Object(L.jsx)(fe,{})})}),document.getElementById("root"))}},[[143,1,2]]]);
//# sourceMappingURL=main.e39b4a0b.chunk.js.map