{"ast":null,"code":"import _regeneratorRuntime from\"/home/spav/Documents/Kurs/Assigment-4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/spav/Documents/Kurs/Assigment-4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/spav/Documents/Kurs/Assigment-4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{withRouter,Redirect,Link}from'react-router-dom';import{useMutation}from'@apollo/client';import{GET_ALL_USERS,SIGN_IN}from'../../utils/graphql';import useForm from'../../hooks/useForm';import{Button,Form}from'react-bootstrap';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SignIn=function SignIn(_ref){var history=_ref.history,location=_ref.location,refetch=_ref.refetch;var _useForm=useForm({email:'',password:''}),inputs=_useForm.inputs,handleChange=_useForm.handleChange;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useMutation=useMutation(SIGN_IN),_useMutation2=_slicedToArray(_useMutation,2),signin=_useMutation2[0],loading=_useMutation2[1].loading;useEffect(function(){setError('');},[location.pathname]);var handleSubmitSignIn=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;_context.next=4;return signin({variables:{email:email,password:password},refetchQueries:[{query:GET_ALL_USERS}]});case 4:response=_context.sent;localStorage.setItem('token',response.data.signin.token);_context.next=8;return refetch();case 8:history.push('/');_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);setError(_context.t0.graphQLErrors[0].message);case 14:case\"end\":return _context.stop();}}},_callee,null,[[1,11]]);}));return function handleSubmitSignIn(_x){return _ref2.apply(this,arguments);};}();var email=inputs.email,password=inputs.password;return/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmitSignIn,children:[/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"E-Mail\"}),/*#__PURE__*/_jsx(Form.Control,{name:\"email\",type:\"text\",value:email,placeholder:\"email\",onChange:handleChange})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"formBasicPassword\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",name:\"password\",value:password,placeholder:\"password\",onChange:handleChange})]}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",children:\"Sign In\"})]});};export default withRouter(SignIn);","map":{"version":3,"sources":["/home/spav/Documents/Kurs/Assigment-4/client/src/pages/Auth/SignIn.js"],"names":["React","useState","useEffect","withRouter","Redirect","Link","useMutation","GET_ALL_USERS","SIGN_IN","useForm","Button","Form","SignIn","history","location","refetch","email","password","inputs","handleChange","error","setError","signin","loading","pathname","handleSubmitSignIn","e","preventDefault","variables","refetchQueries","query","response","localStorage","setItem","data","token","push","graphQLErrors","message"],"mappings":"seAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CAEA,OAASC,UAAT,CAAqBC,QAArB,CAA+BC,IAA/B,KAA2C,kBAA3C,CACA,OAASC,WAAT,KAA4B,gBAA5B,CACA,OAASC,aAAT,CAAwBC,OAAxB,KAAuC,qBAAvC,CACA,MAAOC,CAAAA,OAAP,KAAoB,qBAApB,CACA,OAASC,MAAT,CAAiBC,IAAjB,KAA4B,iBAA5B,C,wFAGA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,MAAoC,IAAjCC,CAAAA,OAAiC,MAAjCA,OAAiC,CAAxBC,QAAwB,MAAxBA,QAAwB,CAAdC,OAAc,MAAdA,OAAc,CACjD,aAA+BN,OAAO,CAAC,CACrCO,KAAK,CAAE,EAD8B,CAErCC,QAAQ,CAAE,EAF2B,CAAD,CAAtC,CAAOC,MAAP,UAAOA,MAAP,CAAeC,YAAf,UAAeA,YAAf,CAIA,cAA0BlB,QAAQ,CAAC,EAAD,CAAlC,wCAAOmB,KAAP,eAAcC,QAAd,eACA,iBAA8Bf,WAAW,CAACE,OAAD,CAAzC,8CAAOc,MAAP,kBAAiBC,OAAjB,kBAAiBA,OAAjB,CAGArB,SAAS,CAAC,UAAM,CACdmB,QAAQ,CAAC,EAAD,CAAR,CACD,CAFQ,CAEN,CAACP,QAAQ,CAACU,QAAV,CAFM,CAAT,CAKA,GAAMC,CAAAA,kBAAkB,2FAAG,iBAAOC,CAAP,+HACzBA,CAAC,CAACC,cAAF,GADyB,sCAIAL,CAAAA,MAAM,CAAC,CAC5BM,SAAS,CAAE,CAAGZ,KAAK,CAALA,KAAH,CAAUC,QAAQ,CAARA,QAAV,CADiB,CAE5BY,cAAc,CAAE,CAAC,CAACC,KAAK,CAAEvB,aAAR,CAAD,CAFY,CAAD,CAJN,QAIjBwB,QAJiB,eAQvBC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BF,QAAQ,CAACG,IAAT,CAAcZ,MAAd,CAAqBa,KAAnD,EARuB,sBASjBpB,CAAAA,OAAO,EATU,QAUvBF,OAAO,CAACuB,IAAR,CAAa,GAAb,EAVuB,iFAYvBf,QAAQ,CAAC,YAAMgB,aAAN,CAAoB,CAApB,EAAuBC,OAAxB,CAAR,CAZuB,qEAAH,kBAAlBb,CAAAA,kBAAkB,6CAAxB,CAgBA,GAAQT,CAAAA,KAAR,CAA4BE,MAA5B,CAAQF,KAAR,CAAeC,QAAf,CAA4BC,MAA5B,CAAeD,QAAf,CAEA,mBAEI,MAAC,IAAD,EAAM,QAAQ,CAAEQ,kBAAhB,wBACE,MAAC,IAAD,CAAM,KAAN,yBACA,KAAC,IAAD,CAAM,KAAN,qBADA,cAEE,KAAC,IAAD,CAAM,OAAN,EAAc,IAAI,CAAC,OAAnB,CAA2B,IAAI,CAAC,MAAhC,CAAuC,KAAK,CAAET,KAA9C,CAAqD,WAAW,CAAC,OAAjE,CAAyE,QAAQ,CAAEG,YAAnF,EAFF,GADF,cAME,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,mBAAtB,wBACE,KAAC,IAAD,CAAM,KAAN,uBADF,cAEE,KAAC,IAAD,CAAM,OAAN,EAAc,IAAI,CAAC,UAAnB,CAA8B,IAAI,CAAC,UAAnC,CAA8C,KAAK,CAAEF,QAArD,CAA+D,WAAW,CAAC,UAA3E,CAAsF,QAAQ,CAAEE,YAAhG,EAFF,GANF,cAUE,KAAC,MAAD,EAAQ,OAAO,CAAC,SAAhB,CAA0B,IAAI,CAAC,QAA/B,qBAVF,GAFJ,CAkBD,CAlDD,CAyDA,cAAehB,CAAAA,UAAU,CAACS,MAAD,CAAzB","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { withRouter, Redirect, Link } from 'react-router-dom';\nimport { useMutation } from '@apollo/client';\nimport { GET_ALL_USERS, SIGN_IN } from '../../utils/graphql';\nimport useForm from '../../hooks/useForm';\nimport { Button, Form} from 'react-bootstrap';\n\n\nconst SignIn = ({ history, location, refetch }) => {\n  const {inputs, handleChange} = useForm({\n    email: '',\n    password: ''\n  });\n  const [error, setError] = useState('');\n  const [signin, { loading }] = useMutation(SIGN_IN);\n\n\n  useEffect(() => {\n    setError('');\n  }, [location.pathname]);\n\n\n  const handleSubmitSignIn = async (e) => {\n    e.preventDefault();\n\n    try {\n      const response = await signin({\n        variables: {  email, password  },\n        refetchQueries: [{query: GET_ALL_USERS}]\n      });\n      localStorage.setItem('token', response.data.signin.token);\n      await refetch();\n      history.push('/');\n    } catch (error) {\n      setError(error.graphQLErrors[0].message);\n    }\n  };\n\n  const { email, password } = inputs;\n\n  return (\n    \n      <Form onSubmit={handleSubmitSignIn}>\n        <Form.Group>\n        <Form.Label>E-Mail</Form.Label>\n          <Form.Control name=\"email\" type=\"text\" value={email} placeholder=\"email\" onChange={handleChange} />\n        </Form.Group>\n    \n        <Form.Group controlId=\"formBasicPassword\">\n          <Form.Label>Password</Form.Label>\n          <Form.Control type=\"password\" name=\"password\" value={password} placeholder=\"password\" onChange={handleChange}/>\n        </Form.Group>\n        <Button variant=\"primary\" type=\"submit\">\n          Sign In\n        </Button>\n      </Form>\n   \n  );\n};\n\nSignIn.propTypes = {\n  history: PropTypes.object.isRequired,\n  refetch: PropTypes.func.isRequired,\n};\n\nexport default withRouter(SignIn);"]},"metadata":{},"sourceType":"module"}