{"ast":null,"code":"import _regeneratorRuntime from\"/home/spav/Documents/Kurs/Assigment-4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/spav/Documents/Kurs/Assigment-4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/spav/Documents/Kurs/Assigment-4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{Button,ButtonGroup,Container,Row,Table}from'react-bootstrap';import{useMutation}from'@apollo/client';import{BLOCK_USERS,DELETE_USERS,UNBLOCK_USERS}from'../utils/graphql';import useCheckbox from'../hooks/useCheckbox';import{Checkbox}from'./Checkbox';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function conversionDate(data){var date=new Date(+data);date=date.toString().split(' ');return\"\".concat(date[2],\" \").concat(date[1],\" \").concat(date[3],\" \").concat(date[4]);}function keyId(checkeds){return Object.keys(Object.fromEntries(Object.entries(checkeds).filter(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1];return value!==false;})));}export var TableUsers=function TableUsers(_ref3){var data=_ref3.data,refetchUser=_ref3.refetchUser,refetchAllUsers=_ref3.refetchAllUsers;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),users=_useState2[0],setUsers=_useState2[1];var _useCheckbox=useCheckbox(users),checkeds=_useCheckbox.checkeds,handleChange=_useCheckbox.handleChange,handleChangeAll=_useCheckbox.handleChangeAll,handleChangeNo=_useCheckbox.handleChangeNo;var _useMutation=useMutation(DELETE_USERS),_useMutation2=_slicedToArray(_useMutation,2),deleteUsers=_useMutation2[0],_useMutation2$=_useMutation2[1],loadingDelete=_useMutation2$.loading,errorDelete=_useMutation2$.error;var _useMutation3=useMutation(BLOCK_USERS),_useMutation4=_slicedToArray(_useMutation3,2),blockUsers=_useMutation4[0],_useMutation4$=_useMutation4[1],loadingBlock=_useMutation4$.loading,errorBlock=_useMutation4$.error;var _useMutation5=useMutation(UNBLOCK_USERS),_useMutation6=_slicedToArray(_useMutation5,2),unBlockUsers=_useMutation6[0],_useMutation6$=_useMutation6[1],loadingUnBlock=_useMutation6$.loading,errorUnBlock=_useMutation6$.error;var handlerBlock=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var blockId;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;blockId=keyId(checkeds);_context.next=4;return blockUsers({variables:{usersIds:blockId}});case 4:_context.next=6;return refetchUser();case 6:_context.next=8;return refetchAllUsers();case 8:_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function handlerBlock(){return _ref4.apply(this,arguments);};}();var handlerUnBlock=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var unBlockId;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;unBlockId=keyId(checkeds);_context2.next=4;return unBlockUsers({variables:{usersIds:unBlockId}});case 4:_context2.next=6;return refetchUser();case 6:_context2.next=8;return refetchAllUsers();case 8:_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,10]]);}));return function handlerUnBlock(){return _ref5.apply(this,arguments);};}();var handlerDelete=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var deleteId;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;deleteId=keyId(checkeds);_context3.next=4;return deleteUsers({variables:{usersIds:deleteId}});case 4:_context3.next=6;return refetchUser();case 6:_context3.next=8;return refetchAllUsers();case 8:_context3.next=13;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 13:case\"end\":return _context3.stop();}}},_callee3,null,[[0,10]]);}));return function handlerDelete(){return _ref6.apply(this,arguments);};}();var handlerRefetch=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return refetchAllUsers();case 3:_context4.next=5;return refetchUser();case 5:_context4.next=10;break;case 7:_context4.prev=7;_context4.t0=_context4[\"catch\"](0);console.log(_context4.t0);case 10:case\"end\":return _context4.stop();}}},_callee4,null,[[0,7]]);}));return function handlerRefetch(){return _ref7.apply(this,arguments);};}();useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:setUsers(data);_context5.next=3;return refetchAllUsers();case 3:case\"end\":return _context5.stop();}}},_callee5);})),[data]);return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Row,{className:\"justify-content-center\",children:/*#__PURE__*/_jsxs(ButtonGroup,{children:[/*#__PURE__*/_jsx(Button,{onClick:handlerBlock,children:\"Block\"}),/*#__PURE__*/_jsx(Button,{onClick:handlerUnBlock,children:\"UnBlock\"}),/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:handlerDelete,children:\"Delete\"}),/*#__PURE__*/_jsx(Button,{variant:\"success\",onClick:handlerRefetch,children:\"UpdateUsers\"})]})}),/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsxs(ButtonGroup,{size:\"sm\",children:[/*#__PURE__*/_jsx(Button,{onClick:handleChangeAll,children:\"All\"}),/*#__PURE__*/_jsx(Button,{onClick:handleChangeNo,children:\"No\"})]})}),/*#__PURE__*/_jsx(\"th\",{children:\"Id\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Last Login\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Online Offline\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status Block\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.map(function(u,i){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Checkbox,{name:u.id,checked:checkeds[u.id],onChange:handleChange})}),/*#__PURE__*/_jsx(\"td\",{children:u.id}),/*#__PURE__*/_jsx(\"td\",{children:u.name}),/*#__PURE__*/_jsx(\"td\",{children:u.email}),/*#__PURE__*/_jsx(\"td\",{children:conversionDate(u.createdAt)}),/*#__PURE__*/_jsx(\"td\",{children:conversionDate(u.lastLoginAt)}),/*#__PURE__*/_jsx(\"td\",{children:u.isOnline===true?'Online':'Offline'}),/*#__PURE__*/_jsx(\"td\",{children:u.active===true?'Not Blocked':'Blocked'})]},u.id);})})]})]});};","map":{"version":3,"sources":["/home/spav/Documents/Kurs/Assigment-4/client/src/components/Table.js"],"names":["React","useEffect","useState","Button","ButtonGroup","Container","Row","Table","useMutation","BLOCK_USERS","DELETE_USERS","UNBLOCK_USERS","useCheckbox","Checkbox","conversionDate","data","date","Date","toString","split","keyId","checkeds","Object","keys","fromEntries","entries","filter","key","value","TableUsers","refetchUser","refetchAllUsers","users","setUsers","handleChange","handleChangeAll","handleChangeNo","deleteUsers","loadingDelete","loading","errorDelete","error","blockUsers","loadingBlock","errorBlock","unBlockUsers","loadingUnBlock","errorUnBlock","handlerBlock","blockId","variables","usersIds","console","log","handlerUnBlock","unBlockId","handlerDelete","deleteId","handlerRefetch","map","u","i","id","name","email","createdAt","lastLoginAt","isOnline","active"],"mappings":"seAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CAEA,OAASC,MAAT,CAAiBC,WAAjB,CAA8BC,SAA9B,CAAyCC,GAAzC,CAA8CC,KAA9C,KAA4D,iBAA5D,CACA,OAASC,WAAT,KAA4B,gBAA5B,CACA,OAASC,WAAT,CAAsBC,YAAtB,CAAoCC,aAApC,KAAyD,kBAAzD,CACA,MAAOC,CAAAA,WAAP,KAAwB,sBAAxB,CACA,OAASC,QAAT,KAAyB,YAAzB,C,wFAEA,QAASC,CAAAA,cAAT,CAAwBC,IAAxB,CAA8B,CAC5B,GAAIC,CAAAA,IAAI,CAAG,GAAIC,CAAAA,IAAJ,CAAS,CAACF,IAAV,CAAX,CACAC,IAAI,CAAGA,IAAI,CAACE,QAAL,GAAgBC,KAAhB,CAAsB,GAAtB,CAAP,CACA,gBAAUH,IAAI,CAAC,CAAD,CAAd,aAAqBA,IAAI,CAAC,CAAD,CAAzB,aAAgCA,IAAI,CAAC,CAAD,CAApC,aAA2CA,IAAI,CAAC,CAAD,CAA/C,EACD,CAED,QAASI,CAAAA,KAAT,CAAeC,QAAf,CAAwB,CACtB,MAAOC,CAAAA,MAAM,CAACC,IAAP,CAAYD,MAAM,CAACE,WAAP,CAAmBF,MAAM,CAACG,OAAP,CAAeJ,QAAf,EAAyBK,MAAzB,CAAgC,cAAiB,kCAAfC,GAAe,UAAXC,KAAW,UACrF,MAAOA,CAAAA,KAAK,GAAK,KAAjB,CACD,CAFqC,CAAnB,CAAZ,CAAP,CAGD,CAED,MAAO,IAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,OAAyC,IAAvCd,CAAAA,IAAuC,OAAvCA,IAAuC,CAAjCe,WAAiC,OAAjCA,WAAiC,CAArBC,eAAqB,OAArBA,eAAqB,CAC/D,cAA0B7B,QAAQ,CAAC,EAAD,CAAlC,wCAAO8B,KAAP,eAAcC,QAAd,eAEA,iBAAkErB,WAAW,CAACoB,KAAD,CAA7E,CAAOX,QAAP,cAAOA,QAAP,CAAiBa,YAAjB,cAAiBA,YAAjB,CAA+BC,eAA/B,cAA+BA,eAA/B,CAAgDC,cAAhD,cAAgDA,cAAhD,CAEA,iBAAmE5B,WAAW,CAACE,YAAD,CAA9E,8CAAM2B,WAAN,kDAA6BC,aAA7B,gBAAoBC,OAApB,CAAmDC,WAAnD,gBAA4CC,KAA5C,CAEA,kBAAgEjC,WAAW,CAACC,WAAD,CAA3E,+CAAMiC,UAAN,kDAA4BC,YAA5B,gBAAmBJ,OAAnB,CAAiDK,UAAjD,gBAA0CH,KAA1C,CACA,kBAAsEjC,WAAW,CAACG,aAAD,CAAjF,+CAAMkC,YAAN,kDAA8BC,cAA9B,gBAAqBP,OAArB,CAAqDQ,YAArD,gBAA8CN,KAA9C,CACA,GAAMO,CAAAA,YAAY,2FAAG,+JAEXC,OAFW,CAED7B,KAAK,CAACC,QAAD,CAFJ,uBAIXqB,CAAAA,UAAU,CAAC,CACfQ,SAAS,CAAG,CACVC,QAAQ,CAACF,OADC,CADG,CAAD,CAJC,8BASXnB,CAAAA,WAAW,EATA,8BAUXC,CAAAA,eAAe,EAVJ,yFAYjBqB,OAAO,CAACC,GAAR,cAZiB,qEAAH,kBAAZL,CAAAA,YAAY,2CAAlB,CAgBA,GAAMM,CAAAA,cAAc,2FAAG,uKAEbC,SAFa,CAEDnC,KAAK,CAACC,QAAD,CAFJ,wBAIbwB,CAAAA,YAAY,CAAC,CACjBK,SAAS,CAAG,CACVC,QAAQ,CAACI,SADC,CADK,CAAD,CAJC,+BASbzB,CAAAA,WAAW,EATE,+BAUbC,CAAAA,eAAe,EAVF,6FAYnBqB,OAAO,CAACC,GAAR,eAZmB,uEAAH,kBAAdC,CAAAA,cAAc,2CAApB,CAgBA,GAAME,CAAAA,aAAa,2FAAG,sKAEZC,QAFY,CAEDrC,KAAK,CAACC,QAAD,CAFJ,wBAIZgB,CAAAA,WAAW,CAAC,CAChBa,SAAS,CAAG,CACVC,QAAQ,CAACM,QADC,CADI,CAAD,CAJC,+BASZ3B,CAAAA,WAAW,EATC,+BAUZC,CAAAA,eAAe,EAVH,6FAYlBqB,OAAO,CAACC,GAAR,eAZkB,uEAAH,kBAAbG,CAAAA,aAAa,2CAAnB,CAgBA,GAAME,CAAAA,cAAc,2FAAG,gLAEb3B,CAAAA,eAAe,EAFF,+BAGbD,CAAAA,WAAW,EAHE,2FAKnBsB,OAAO,CAACC,GAAR,eALmB,sEAAH,kBAAdK,CAAAA,cAAc,2CAApB,CAQAzD,SAAS,sEAAC,wIACNgC,QAAQ,CAAClB,IAAD,CAAR,CADM,uBAEAgB,CAAAA,eAAe,EAFf,yDAAD,GAGN,CAAChB,IAAD,CAHM,CAAT,CAMA,mBACE,MAAC,SAAD,yBACA,KAAC,GAAD,EAAK,SAAS,CAAC,wBAAf,uBACE,MAAC,WAAD,yBACE,KAAC,MAAD,EAAQ,OAAO,CAAEiC,YAAjB,mBADF,cAEE,KAAC,MAAD,EAAQ,OAAO,CAAEM,cAAjB,qBAFF,cAGE,KAAC,MAAD,EAAQ,OAAO,CAAC,QAAhB,CAAyB,OAAO,CAAEE,aAAlC,oBAHF,cAIE,KAAC,MAAD,EAAQ,OAAO,CAAC,SAAhB,CAA0B,OAAO,CAAEE,cAAnC,yBAJF,GADF,EADA,cAUE,MAAC,KAAD,EAAO,OAAO,KAAd,CAAe,QAAQ,KAAvB,CAAwB,KAAK,KAA7B,wBACI,oCACE,mCACE,iCACA,MAAC,WAAD,EAAa,IAAI,CAAC,IAAlB,wBACE,KAAC,MAAD,EAAQ,OAAO,CAAEvB,eAAjB,iBADF,cAIE,KAAC,MAAD,EAAQ,OAAO,CAAEC,cAAjB,gBAJF,GADA,EADF,cAYE,0BAZF,cAaE,4BAbF,cAcE,6BAdF,cAeE,4BAfF,cAgBE,kCAhBF,cAiBE,sCAjBF,cAkBE,oCAlBF,GADF,EADJ,cAuBI,uBACCJ,KAAK,CAAC2B,GAAN,CAAU,SAACC,CAAD,CAAIC,CAAJ,CAAS,CACpB,mBACI,mCACE,iCACA,KAAC,QAAD,EAAU,IAAI,CAAED,CAAC,CAACE,EAAlB,CAAsB,OAAO,CAAEzC,QAAQ,CAACuC,CAAC,CAACE,EAAH,CAAvC,CAA+C,QAAQ,CAAE5B,YAAzD,EADA,EADF,cAIE,oBAAK0B,CAAC,CAACE,EAAP,EAJF,cAKE,oBAAKF,CAAC,CAACG,IAAP,EALF,cAME,oBAAKH,CAAC,CAACI,KAAP,EANF,cAOE,oBAAKlD,cAAc,CAAC8C,CAAC,CAACK,SAAH,CAAnB,EAPF,cAQE,oBAAKnD,cAAc,CAAC8C,CAAC,CAACM,WAAH,CAAnB,EARF,cASE,oBAAKN,CAAC,CAACO,QAAF,GAAe,IAAf,CAAsB,QAAtB,CAAiC,SAAtC,EATF,cAUE,oBAAKP,CAAC,CAACQ,MAAF,GAAa,IAAb,CAAoB,aAApB,CAAoC,SAAzC,EAVF,GAASR,CAAC,CAACE,EAAX,CADJ,CAcC,CAfA,CADD,EAvBJ,GAVF,GADF,CAwDH,CA/HM","sourcesContent":["import React, { useEffect, useState } from 'react'\n\nimport { Button, ButtonGroup, Container, Row, Table  } from 'react-bootstrap';\nimport { useMutation } from '@apollo/client';\nimport { BLOCK_USERS, DELETE_USERS, UNBLOCK_USERS } from '../utils/graphql';\nimport useCheckbox from '../hooks/useCheckbox';\nimport { Checkbox } from './Checkbox';\n\nfunction conversionDate(data) {\n  let date = new Date(+data);\n  date = date.toString().split(' ')\n  return `${date[2]} ${date[1]} ${date[3]} ${date[4]}`;\n}\n\nfunction keyId(checkeds){\n  return Object.keys(Object.fromEntries(Object.entries(checkeds).filter(([key,value]) => {\n    return value !== false\n  })));\n}\n\nexport const TableUsers = ({data, refetchUser,refetchAllUsers}) => {\n    const [users, setUsers] = useState([])\n\n    const {checkeds, handleChange, handleChangeAll, handleChangeNo} = useCheckbox(users)\n\n    const[deleteUsers,{ loading: loadingDelete, error: errorDelete}] = useMutation(DELETE_USERS)\n    \n    const[blockUsers,{ loading: loadingBlock, error: errorBlock}] = useMutation(BLOCK_USERS)\n    const[unBlockUsers,{ loading: loadingUnBlock, error: errorUnBlock}] = useMutation(UNBLOCK_USERS)\n    const handlerBlock = async() => {\n      try {\n        const blockId = keyId(checkeds);\n\n        await blockUsers({\n          variables:  {\n            usersIds:blockId,\n        },    \n        })\n        await refetchUser()\n        await refetchAllUsers()\n      }catch(e) {\n        console.log(e);\n      }\n    } \n\n    const handlerUnBlock = async() => {\n      try {\n        const unBlockId = keyId(checkeds);\n        \n        await unBlockUsers({\n          variables:  {\n            usersIds:unBlockId,\n        },    \n        })\n        await refetchUser()\n        await refetchAllUsers()\n      }catch(e) {\n        console.log(e);\n      }\n    }\n\n    const handlerDelete = async () => {\n      try {\n        const deleteId = keyId(checkeds)\n\n        await deleteUsers({\n          variables:  {\n            usersIds:deleteId,\n        },    \n        })\n        await refetchUser()\n        await refetchAllUsers()\n      }catch(e) {\n        console.log(e);\n      }\n    }    \n    \n    const handlerRefetch = async () => {\n      try{\n        await refetchAllUsers()\n        await refetchUser()\n      }catch(e){\n        console.log(e);\n      }\n    }\n    useEffect(async() => {\n        setUsers(data)\n        await refetchAllUsers()\n    }, [data])\n  \n\n    return (\n      <Container>\n      <Row className=\"justify-content-center\">\n        <ButtonGroup>\n          <Button onClick={handlerBlock}>Block</Button>\n          <Button onClick={handlerUnBlock}>UnBlock</Button>\n          <Button variant=\"danger\" onClick={handlerDelete}>Delete</Button>\n          <Button variant=\"success\" onClick={handlerRefetch}>UpdateUsers</Button>\n        </ButtonGroup>\n      </Row>\n      \n        <Table striped bordered hover >\n            <thead>\n              <tr>\n                <th>\n                <ButtonGroup size=\"sm\">\n                  <Button onClick={handleChangeAll}>\n                  All\n                  </Button>\n                  <Button onClick={handleChangeNo}>\n                  No\n                  </Button>\n                </ButtonGroup>\n                \n                </th>\n                <th>Id</th>\n                <th>Name</th>\n                <th>Email</th>\n                <th>Date</th>\n                <th>Last Login</th>\n                <th>Online Offline</th>\n                <th>Status Block</th>\n              </tr>\n            </thead>\n            <tbody>\n            {users.map((u, i)=> {\n            return (\n                <tr key={u.id}>\n                  <td>\n                  <Checkbox name={u.id} checked={checkeds[u.id]} onChange={handleChange} />\n                  </td>\n                  <td>{u.id}</td>\n                  <td>{u.name}</td>\n                  <td>{u.email}</td>\n                  <td>{conversionDate(u.createdAt)}</td>\n                  <td>{conversionDate(u.lastLoginAt)}</td>\n                  <td>{u.isOnline === true ? 'Online' : 'Offline'}</td>\n                  <td>{u.active === true ? 'Not Blocked' : 'Blocked'}</td>\n                </tr>\n            )\n            })\n            }\n        </tbody>\n        </Table>\n        </Container>\n    )\n}\n\n\n"]},"metadata":{},"sourceType":"module"}